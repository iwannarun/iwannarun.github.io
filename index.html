<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="我要稳稳的RUN" />





  <link rel="alternate" href="/atom.xml" title="我要稳稳的RUN's Blogss" type="application/atom+xml" />






<meta property="og:type" content="website">
<meta property="og:title" content="我要稳稳的RUN&#39;s Blogss">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="我要稳稳的RUN&#39;s Blogss">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我要稳稳的RUN&#39;s Blogss">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'IGNJ2KF5V6',
      apiKey: 'faf94c3620d6ff8b24a9a6f48e6ea18f',
      indexName: 'blog_product',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>我要稳稳的RUN's Blogss</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?40fd86df894facfd47d5e96c439ede7c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">我要稳稳的RUN's Blogss</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">I WANNA RUN</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/01/My-New-Post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/01/My-New-Post/" itemprop="url">你好，Hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-01T23:41:47+08:00">
                2017-10-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/10/01/My-New-Post/" class="leancloud_visitors" data-flag-title="你好，Hexo">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>  首先，这是在Hexo的第一篇博客，那么就先来说说选择Hexo的理由。<br>  由于自己懒癌，原先的Ghost这几个月都没更新了。并非不想记录，而是每次想记点东西的时候想到Ghost写个博客需要先登录博客后台(手动输入博客域名/ghost)，接着输入账号密码(浏览器通常没存)，写的时候又要在编辑器上调整格式，发布后预览检查主题带来的显示差异…想到这总嫌麻烦就不写了。<br>  现在有了Hexo，记录博客的方式发生了质的改变。 创建一篇新的文章，本地写好MD文件，保存一下后就是类似提交文件到预置的git仓库的操作，<code>hexo deploy</code>一下就自动发布到gitpage了，这样的一套操作下来真的是如丝顺滑，颇有持续集成的感觉。<br>  至于这款博客其他的功能体验，目前单博客的配置方式就足够吸引我了。Hexo以.yml语法进行站点配置对于程序员来说是友好的。<code>gayhub.com</code>上前端大大们开源的主题看了一圈，大都还挺有新意的，可玩性会比Ghost高些。其他部分还在体验当中。</p>
<p> So，后续会把阿里云机器上ghost博客迁移到这里来，想想每个月省下的主机费用还可以多几买本书或者女票的口红，嗯乐滋滋。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/08/pecs-producer-extends-consumer-super-de-yi-si/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/08/pecs-producer-extends-consumer-super-de-yi-si/" itemprop="url">编程规范:泛型的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-08T15:23:05+08:00">
                2017-09-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/09/08/pecs-producer-extends-consumer-super-de-yi-si/" class="leancloud_visitors" data-flag-title="编程规范:泛型的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>遵守PECS(Producer Extends Consumer Super)原则</p>
</blockquote>
<h1 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h1><ol>
<li>频繁往外读取内容的，适合用上界 Extends。</li>
<li>经常往里插入的，适合用下界 Super。</li>
</ol>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><pre><code>Java中，泛型通配符&lt;? extends T&gt;来接收返回的数据，此写法的泛型集合不能使用add方 法，而&lt;? super T&gt;不能使用get方法，做为接口调用赋值时易出错。
</code></pre><h1 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h1><pre><code> &lt;? extends T&gt;, ? 必须是T或T的子类集合写(add)： 因为不能确定集合实例化时用的是T或T的子类，所以没有办法写。例如：
List&lt;? extends Number&gt; foo = new ArrayList&lt;Number/Integer/Double&gt;()，你不能add Number，因为也可能是Integer或Double的List， 同理也不能add Integer或Double，即，extends T， 不能集合add。集合读(get)： 只能读出T类型的数据。&lt;? super T&gt;， ? 必须是T或T的父类集合写(add)： 可以add T或T的子类。集合读(get)： 不能确定从集合里读出的是哪个类型(可能是T也可能是T的父类，或者Object)，所以没有办法使用get。例如：List&lt;? super Integer&gt; foo3 = new ArrayList&lt;Integer/Number/Object&gt;(); 只能保证get出来是Object。
</code></pre><p>下面是示例，test1和test2在编译时都有错误提示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">package com.robert.javaspec; </div><div class="line"> </div><div class="line">import java.util.LinkedList; </div><div class="line">import java.util.List; </div><div class="line"> </div><div class="line">/** </div><div class="line">* Created by WangMeng on 2017-04-13. </div><div class="line">* FIX ME </div><div class="line">*/ </div><div class="line">public class Main &#123; </div><div class="line">  public static void main(String[] args) &#123; </div><div class="line"> </div><div class="line">  &#125; </div><div class="line"> </div><div class="line">  public void test1()&#123; </div><div class="line">      List&lt;? extends A&gt; childofa=new LinkedList&lt;&gt;(); </div><div class="line">      B b=new B(); </div><div class="line">      A a=new A(); </div><div class="line">      childofa.add(a); </div><div class="line">      childofa.add(b); </div><div class="line">      A ta= childofa.get(0); </div><div class="line">  &#125; </div><div class="line"> </div><div class="line">  public void test2()&#123; </div><div class="line">      List&lt;? super B&gt; superOfb = new LinkedList&lt;&gt;(); </div><div class="line">      B b = new B(); </div><div class="line">      A a = new A(); </div><div class="line">      superOfb.add(a); </div><div class="line">      superOfb.add(b); </div><div class="line">      A ta = superOfb.get(0); </div><div class="line">      B tb = superOfb.get(0); </div><div class="line">  &#125; </div><div class="line">&#125; </div><div class="line"> </div><div class="line">class A &#123; </div><div class="line">  @Override </div><div class="line">  public String toString() &#123; </div><div class="line">      return &quot;A&quot;; </div><div class="line">  &#125; </div><div class="line">&#125; </div><div class="line"> </div><div class="line">class B extends A &#123; </div><div class="line"> </div><div class="line">  @Override </div><div class="line">  public String toString() &#123; </div><div class="line">      return &quot;B&quot;; </div><div class="line">  &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="https://yq.aliyun.com/articles/181420?spm=5176.100240.searchblog.35.CUGecC" target="_blank" rel="external">转自https://yq.aliyun.com/articles/181420?spm=5176.100240.searchblog.35.CUGecC</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/03/yi-duan-pi-liang-cha-ru-sql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/03/yi-duan-pi-liang-cha-ru-sql/" itemprop="url">一段批量插入sql脚本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-03T16:56:38+08:00">
                2017-08-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/08/03/yi-duan-pi-liang-cha-ru-sql/" class="leancloud_visitors" data-flag-title="一段批量插入sql脚本">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">i=1;</div><div class="line">MAX_INSERT_ROW_COUNT=$1;</div><div class="line">while [ $i -le $MAX_INSERT_ROW_COUNT ]</div><div class="line">do</div><div class="line">    echo &quot;INSERT INTO player (os,username,password,nickname,emoney,dataComplete,roomId,clubId,lastOnlineTime,diamond,personalizedSignature,sex,imgUrl,codeCheck,code,codeLastTime,vipType,vipValid,inSss,countryCode,inSng,isAdmin,speak_ban,ip) VALUES (&apos;1&apos;, &apos;44444$i&apos;, &apos;123456&apos;, &apos;TEST$i&apos;, &apos;100000&apos;, &apos;1&apos;, &apos;0&apos;, &apos;0&apos;, &apos;1473237255&apos;, &apos;10000&apos;, &apos;&apos;, &apos;1&apos;, &apos;&apos;, &apos;1&apos;, &apos;834162&apos;, &apos;1473237255&apos;, &apos;0&apos;, &apos;0&apos;, &apos;0&apos;, &apos;86&apos;, &apos;0&apos;, &apos;0&apos;, &apos;0&apos;, &apos;&apos;);&quot; &gt;&gt; player.sql</div><div class="line">    d=$(date +%M-%d\ %H\:%m\:%S)</div><div class="line">    echo &quot;INSERT HELLO $i @@ $d&quot;</div><div class="line">    i=$(($i+1))</div><div class="line"></div><div class="line">done</div><div class="line">exit 0</div></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/17/web/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/17/web/" itemprop="url">Web常见攻击手段和维护</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-17T21:12:19+08:00">
                2017-06-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/17/web/" class="leancloud_visitors" data-flag-title="Web常见攻击手段和维护">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>一、SQL注入攻击</strong></p>
<p>解决方案：</p>
<ol>
<li>前端页面校验用户的输入数据（限制用户输入的类型、范围、格式、长度等）。</li>
<li>后端对提交的数据进行严格校验，数据存储时不要使用“+”号拼接sql，采用预编译sql，防止注入！</li>
<li>使用自定义错误页，防止用户通过服务器默认的错误页面找到服务器漏洞。</li>
</ol>
<p><strong>二、XSS跨站脚本攻击</strong></p>
<p>攻击方式：基于DOM的XSS即通过浏览器来直接运行js脚本，无须提交服务器，从客户端的代码引起的。</p>
<pre><code>如：其实就是发送一个合法的地址加自己的脚本，比如：
</code></pre> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">www.xxx.com/search?wd=&lt;script&gt;...&lt;/script&gt;</div></pre></td></tr></table></figure>
<p> 受害者点击的是<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">www.xxx.com/search?wd=&lt;script&gt;...&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p> 链接，然后受害者的浏览网页就加入这个恶意代码。存储XSS攻击即通过输入框提交js脚本或者上传文件到服务器，从网站的数据库引起的攻击。反射XSS攻击即通过url提交js脚本到服务器，从受害人的请求发起引起的攻击。 目的：盗取用户的登陆账户密码，收集用户的cookie等敏感信息。 解决方案：后端输出页面的时候将参数进行转义。如<code>&lt;script&gt;</code>转义成 <code>&lt;script&gt;</code>过滤用户输入。 注意：xss攻击的地方很多，html、css、js都有可能会被注入威胁。 </p>
<p><strong>三、CSRF跨站请求伪造攻击</strong> </p>
<p>攻击方式：利用收集到的用户cookie或其他敏感信息，使用httpclient等工具模拟请求，盗取用户信息。 解决方案：验证HTTP Referer字段，服务器端生成一次性token，请求时验证token。 </p>
<p><strong>四、DoS攻击</strong></p>
<p>攻击方式：Ping Flood攻击即利用ping命令不停的发送的数据包到服务器，占用服务器带宽，直到网络瘫痪。SYN Flood攻击即利用tcp协议原理，伪造受害者的ip地址，一直保持与服务器的连接，导致受害者连接服务器的时候拒绝服务。 </p>
<p>解决方案：设置防火墙。使用阿里云高防IP。 </p>
<p><strong>五、ARP欺骗——常见的窃取资料的安全性问题</strong></p>
<p>攻击方式：利用ARP欺骗，伪造成网关，让受害者的数据经过攻击者的电脑，从而抓取别人的用户信息。 解决方案：强烈要求数据必须加密传输，启动https协议。</p>
<p><strong>六、中间人攻击（会话劫持）—–常见的窃取资料的安全性问题</strong></p>
<p>攻击方式：劫持会话cookies，把受害者（A）与受害者（B）之间通信经过攻击者的电脑。（常见于在线聊天系统） </p>
<p>解决方案：用户进行二次验证，随机产生会话ID，会话cookies设置httponly。 </p>
<p>cookies的两种类型 </p>
<ul>
<li>会话cookies : 建立会话的cookies，关闭浏览器失效。 </li>
<li>持久性cookies: 持久保存本地的cookies，到期失效。 会话cookies ！= session cookies会受到XSS，CSRF攻击。（把恶意代码存放到cookies里面） </li>
</ul>
<p><strong>七、其他注意的点</strong> </p>
<p>限制上传文件的类型和权限，防止用户上传jsp和服务器脚本！ 删除服务器默认的示例demo，如tomcat下的webapps下的默认文件！ 关注使用到的技术的更新，如：struts2的远程执行漏洞。及时更新到bug fixed版本。</p>
<p>转自<a href="http://www.dreamlu.net" target="_blank" rel="external">如梦技术</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/06/tomcat-e9-87-8d-e5-90-af-e8-84-9a-e6-9c-ac/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/06/tomcat-e9-87-8d-e5-90-af-e8-84-9a-e6-9c-ac/" itemprop="url">Tomcat重新部署和备份脚本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T19:50:12+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/06/tomcat-e9-87-8d-e5-90-af-e8-84-9a-e6-9c-ac/" class="leancloud_visitors" data-flag-title="Tomcat重新部署和备份脚本">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>查询指定服务的tomcat，如果存在对应pid则进行重启，同时对历史版本war包备份</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">#defined </div><div class="line">TOMCAT_HOME=&quot;/data/server/tomcat-adminstock&quot;</div><div class="line">TOMCAT_PORT=20007</div><div class="line">PROJECT=adminstock</div><div class="line"></div><div class="line"></div><div class="line">TomcatID=$(ps -ef |grep tomcat |grep -w $TOMCAT_HOME|grep -v &apos;grep&apos;|awk &apos;&#123;print $2&#125;&apos;)</div><div class="line">if [ -n $TomcatID ];</div><div class="line"></div><div class="line">       then</div><div class="line">                sudo &quot;$TOMCAT_HOME&quot;/bin/shutdown.sh  -force</div><div class="line">                echo &quot;=============tomcat shutdown=================&quot;</div><div class="line">        else</div><div class="line">                echo &quot;=============tomcat not start ===============&quot;</div><div class="line">fi</div><div class="line">#check tomcat process</div><div class="line">tomcat_pid=`/usr/sbin/lsof -n -P -t -i :$TOMCAT_PORT`</div><div class="line">echo &quot;current :&quot; $tomcat_pid</div><div class="line">while [ -n &quot;$tomcat_pid&quot; ]</div><div class="line">do</div><div class="line"> sleep 5</div><div class="line"> tomcat_pid=`/usr/sbin/lsof -n -P -t -i :$TOMCAT_PORT`</div><div class="line"> echo &quot;scan tomcat adminstock pid :&quot; $tomcat_pid</div><div class="line">done</div><div class="line">#publish project</div><div class="line">echo &quot;scan no tomcat adminstock pid,$PROJECT publishing&quot;</div><div class="line">sudo rm -rf &quot;$TOMCAT_HOME&quot;/webapps/$PROJECT*</div><div class="line">sudo cp /data/server/jenkins_slave/workspace/MN_ADMIN/adminstock/target/$PROJECT.war &quot;$TOMCAT_HOME&quot;/webapps/$PROJECT.war</div><div class="line">#bak project</div><div class="line">BAK_DIR=/data/bak/$PROJECT/`date +%Y%m%d`</div><div class="line">sudo mkdir -p &quot;$BAK_DIR&quot;</div><div class="line">sudo cp &quot;$TOMCAT_HOME&quot;/webapps/$PROJECT.war &quot;$BAK_DIR&quot;/&quot;$PROJECT&quot;_`date +%H%M%S`.war</div><div class="line">#remove tmp</div><div class="line">sudo rm -rf /data/bak/$PROJECT*.war</div><div class="line">#start tomcat</div><div class="line"></div><div class="line">cd $TOMCAT_HOME/bin/</div><div class="line">sudo ./startup.sh</div><div class="line">echo &quot;tomcat adminstock is starting,please try to access $PROJECT conslone url&quot; </div><div class="line">sleep 15</div><div class="line">echo &quot;-----------------------------adminstock-----------------------------&quot;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/02/-e5-b8-b8-e7-94-a8aliases-e8-ae-b0-e5-bd-95-e6-8c-81-e7-bb-ad-e6-9b-b4-e6-96-b0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/-e5-b8-b8-e7-94-a8aliases-e8-ae-b0-e5-bd-95-e6-8c-81-e7-bb-ad-e6-9b-b4-e6-96-b0/" itemprop="url">常用aliases记录(持续更新)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T19:21:15+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/02/-e5-b8-b8-e7-94-a8aliases-e8-ae-b0-e5-bd-95-e6-8c-81-e7-bb-ad-e6-9b-b4-e6-96-b0/" class="leancloud_visitors" data-flag-title="常用aliases记录(持续更新)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div></pre></td><td class="code"><pre><div class="line"># 文件按大小排序，</div><div class="line">lbys = ls by size alias lbys=&apos;ls -alhS&apos; </div><div class="line"># 文件按时间排序，lbyt = ls by time alias lbyt=&apos;ls -alht&apos;</div><div class="line"># 重新运行上一条命令，并将输出复制到剪贴板，</div><div class="line">cl = copy last alias </div><div class="line">cl=&apos;bash -c &quot;$(fc -ln -1)&quot; | pbcopy&apos; </div><div class="line"># 复制上一条命令 </div><div class="line">alias last=&apos;fc -ln -1 | pbcopy&apos; </div><div class="line"># 将当前剪贴板里的内容保存到某个文件里 </div><div class="line">alias new=&apos;pbpaste | cat &gt;&apos; alias save=&apos;pbpaste | cat &gt;&apos; alias myip=&apos;curl ifconfig.co&apos; </div><div class="line"># 代理 alias setproxy=&apos;export ALL_PROXY=socks5://127.0.0.1:1086&apos; alias unsetproxy=&apos;unset ALL_PROXY&apos; </div><div class="line"># life query alias tq=&quot;curl wttr.in/shenzhen&quot; </div><div class="line"># brew </div><div class="line">alias bs=&quot;brew services&quot; </div><div class="line">alias bsl=&quot;brew services list&quot; </div><div class="line"># editor </div><div class="line">alias vi=&quot;vim&quot; alias edit=&quot;vim&quot; </div><div class="line">alias grep=&quot;grep -E --color&quot; </div><div class="line">alias egrep=&quot;egrep --color=auto&quot; </div><div class="line">alias fgrep=&quot;fgrep --color=auto&quot; </div><div class="line">alias mkdir=&quot;mkdir -pv&quot; </div><div class="line">alias tf=&apos;tail -f&apos; </div><div class="line">#动态查看文件变化 </div><div class="line">alias af=&quot;awk -F &apos;\t&apos; &apos;&#123;print NF&#125;&apos;&quot; </div><div class="line">#查看文件列数，用\t分隔，最常用，其实也可以搞个通用的，接收参数 </div><div class="line">alias wl=&apos;wc -l&apos; </div><div class="line">#统计行数 </div><div class="line">alias c=&quot;clear&quot;</div><div class="line">#清屏 alias cls=&quot;clear&quot; </div><div class="line">#清屏 </div><div class="line">alias cp=&apos;cp -v&apos; </div><div class="line">alias cpr=&apos;cp -r&apos; </div><div class="line">alias mv=&apos;mv -v&apos; </div><div class="line">alias df=&quot;df -h&quot; </div><div class="line">alias du=&quot;du -h&quot; </div><div class="line">alias dus=&quot;du -s&quot;</div><div class="line">#磁盘 </div><div class="line">alias du0=&quot;du --max-depth=0&quot; </div><div class="line">alias du1=&quot;du --max-depth=1&quot; </div><div class="line">alias last=&quot;last -a&quot; </div><div class="line">alias free=&apos;free -m&apos; </div><div class="line">#Notice: install colordiff </div><div class="line">alias diff=&apos;colordiff&apos; </div><div class="line">alias vd=&apos;vimdiff&apos; </div><div class="line">#vim diff两个文件 </div><div class="line">alias tree=&apos;tree -C&apos; </div><div class="line">alias dfind=&apos;find -type d -name&apos;</div><div class="line">#查找文件夹 </div><div class="line">alias ffind=&apos;find -type f -name&apos; </div><div class="line">#查找文件 </div><div class="line">alias chux=&apos;chmod u+x&apos; </div><div class="line">#该权限 </div><div class="line"># tool </div><div class="line">alias rmpyc=&apos;find . -name &quot;*.pyc&quot; -exec rm -rf &#123;&#125; \; &gt;&gt; /dev/null 2&gt;&amp;1&apos; </div><div class="line">#递归删除目录下所有pyc </div><div class="line">alias rmlog=&apos;rm *.log;rm *.log.*&apos; </div><div class="line">alias now=&apos;date +&quot;%Y-%m-%d %T&quot;&apos; </div><div class="line"># for svn </div><div class="line">alias rmsvn=&apos;find . -name &quot;.svn&quot; -exec rm -rf &#123;&#125; \; &gt;&gt; /dev/null 2&gt;&amp;1&apos;</div><div class="line">#递归删除目录下所有.svn </div><div class="line">alias svnci=&apos;svn ci -m &quot;commit by $USER&quot; &apos; </div><div class="line">#便捷操作，适用一些不重要文件的，不建议适用哈 </div><div class="line">alias svnst=&apos;svn st&apos; </div><div class="line">#少一个空格，少一个是一个......囧 </div><div class="line"># for go </div><div class="line">alias gor=&apos;go run&apos; </div><div class="line">alias gob=&apos;go build&apos; </div><div class="line">#for tmux </div><div class="line">alias tm=&apos;tmux -2&apos; </div><div class="line">alias tmux=&apos;tmux -2&apos; </div><div class="line">alias tma=&apos;tmux -2 attach&apos; </div><div class="line">alias tmx=&apos;tmuxinator&apos; </div><div class="line"># chdir </div><div class="line">alias ..=&quot;cd ..&quot; </div><div class="line">alias cdd=&quot;cd ..&quot; </div><div class="line">alias cd..=&quot;cd ..&quot; </div><div class="line">alias ...=&quot;cd ../..&quot; </div><div class="line">alias ....=&quot;cd ../../..&quot; </div><div class="line">alias .....=&quot;cd ../../../..&quot; </div><div class="line">alias .4=&apos;cd ../../../../&apos; </div><div class="line">alias .5=&apos;cd ../../../../..&apos; </div><div class="line">alias -- -=&apos;cd -&apos; </div><div class="line">alias cds=&apos;echo &quot;`pwd`&quot; &gt; ~/.cdsave&apos; </div><div class="line">#cd save : save where i am </div><div class="line">alias cdb=&apos;cd &quot;`cat ~/.cdsave`&quot;&apos; </div><div class="line"># cd back </div><div class="line"># processes </div><div class="line">alias pg=&apos;ps -ef | grep&apos; </div><div class="line"># services </div><div class="line">alias ms=&apos;mysql -uroot --password=&quot;&quot;&apos; </div><div class="line">#mysql alias ssh=&apos;ssh -2&apos;</div><div class="line"># ls for mac </div><div class="line">alias ll=&apos;ls -al&apos; </div><div class="line">#ls相关，这里--color需要根据终端设 </div><div class="line">alias lx=&apos;ls -lhBX&apos; </div><div class="line">#sort by extension </div><div class="line">alias lz=&apos;ls -lhrS&apos; </div><div class="line">#sort by size </div><div class="line">alias lt=&apos;ls -lhrt&apos; </div><div class="line">#sort by date 最常用到，ls -rt，按修改时间查看目录下文件 alias lsd=&apos;find . -maxdepth 1 -type d | sort&apos; </div><div class="line">#列出所有目录 </div><div class="line">alias sl=&apos;ls&apos; </div><div class="line"># net alias pong=&apos;ping -c 5 &apos; </div><div class="line">#ping，限制 </div><div class="line">alias ports=&apos;netstat -tulanp&apos; </div><div class="line">alias myip=&apos;curl ifconfig.me&apos; </div><div class="line"># useful functions </div><div class="line">#根据文件类型解压 </div><div class="line">#extract()&#123; ext()&#123; if [ -f $1 ]; then case $1 in *.tar.bz2) tar xjf $1 ;; *.tar.gz) tar xzf $1 ;; *.bz2) bunzip2 $1 ;; *.rar) unrar e $1 ;; *.gz) gunzip $1 ;; *.tar) tar xf $1 ;; *.tbz2) tar xjvf $1 ;; *.tgz) tar xzvf $1 ;; *.zip) unzip $1 ;; *.Z) uncompress $1 ;; *.7z) 7z x $1 ;; *) echo &quot;&apos;$1&apos; cannot be extracted via extract()&quot; ;; esac else echo &quot;&apos;$1&apos; is not a valid file&quot; fi &#125; #压缩 mktar()&#123; tar cvf &quot;$&#123;1%%/&#125;.tar&quot; &quot;$&#123;1%%/&#125;/&quot;; &#125; mktgz()&#123; tar cvzf &quot;$&#123;1%%/&#125;.tar.gz&quot; &quot;$&#123;1%%/&#125;/&quot;; &#125; mktbz()&#123; tar cvjf &quot;$&#123;1%%/&#125;.tar.bz2&quot; &quot;$&#123;1%%/&#125;/&quot;; &#125; </div><div class="line">#分屏同时打开多个文件 </div><div class="line">#vim -oN filea fileb filec vo()&#123; vim -o$# $* &#125; </div><div class="line">#创建一个目录并跳转到 </div><div class="line">#make a dir and cd into it mcd()&#123; mkdir -pv &quot;$@&quot; cd &quot;$@&quot; &#125; </div><div class="line">#保存一个文件到tmp </div><div class="line"># save a file to ~/tmp saveit() &#123; cp $1 $&#123;HOME&#125;/tmp/$&#123;1&#125;.saved &#125; </div><div class="line">#交换两个文件 </div><div class="line"># switch two files (comes in handy) switchfile() &#123; mv $1 $&#123;1&#125;.tmp &amp;&amp; mv $2 $1 &amp;&amp; mv $&#123;1&#125;.tmp $2 &#125; </div><div class="line">#查看自己常用命令top n </div><div class="line"># View most commonly used commands. depends on your history output format </div><div class="line">used()&#123; if [ $1 ] then history | awk &apos;&#123;print $4&#125;&apos; | sort | uniq -c | sort -nr | head -n $1 else history | awk &apos;&#123;print $4&#125;&apos; | sort | uniq -c | sort -nr | head -n 10 fi &#125; </div><div class="line">#最常用，复制一个路径过来时，不用修改，可以到达路径的最深一层目录 </div><div class="line">#if dir,cd into it. if file ,cd into where the file is </div><div class="line">goto()&#123; [ -d &quot;$1&quot; ] &amp;&amp; cd &quot;$1&quot; || cd &quot;$(dirname &quot;$1&quot;)&quot;; &#125; </div><div class="line">#临时文件 </div><div class="line">mvtmp()&#123; mv $1 ~/tmp/ &#125; function cptmp()&#123; cp -r $1 ~/tmp/ &#125; </div><div class="line"># Serve directory on localhost:80 servedir()&#123; sudo python -m SimpleHTTPServer 80 &#125; </div><div class="line"># applications </div><div class="line"># aira2 </div><div class="line">alias download=&apos;aria2c&apos; </div><div class="line">alias dl=&apos;aria2c&apos; </div><div class="line"># thefuck </div><div class="line"># tmp </div><div class="line">alias jj=&quot;~/workspace/bin/gossh&quot; </div><div class="line">alias spi=&quot;sudo /usr/local/bin/pip install&quot; </div><div class="line">alias jjj=&quot;~/bin/kw3gossh&quot; </div><div class="line"># install https://github.com/what-studio/profiling alias pypro=&apos;python -m profiling profile&apos; </div><div class="line"># install promptpython alias pt=&apos;ptpython&apos;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/02/kafka-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e5-8f-8a-e7-ae-80-e4-bb-8b/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/kafka-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e5-8f-8a-e7-ae-80-e4-bb-8b/" itemprop="url">Kafka集群搭建及简介</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T17:54:16+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/02/kafka-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e5-8f-8a-e7-ae-80-e4-bb-8b/" class="leancloud_visitors" data-flag-title="Kafka集群搭建及简介">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Kafka集群搭建"><a href="#Kafka集群搭建" class="headerlink" title="Kafka集群搭建"></a>Kafka集群搭建</h2><h3 id="需要集群的服务器上各自下载安装程序"><a href="#需要集群的服务器上各自下载安装程序" class="headerlink" title="需要集群的服务器上各自下载安装程序"></a>需要集群的服务器上各自下载安装程序</h3><pre><code>wget https://www.apache.org/dyn/closer.cgi?path=/kafka/0.10.2.1/kafka_2.12-0.10.2.1.tgz tar -xzvf kafka_2.12-0.10.2.1.tgz
</code></pre><h3 id="分别修改server-properties"><a href="#分别修改server-properties" class="headerlink" title="分别修改server.properties"></a>分别修改server.properties</h3><pre><code>broker.id=0（1、2、3...） zookeeper.connect=192.168.199.248:2181,192.168.199.170:2181,192.168.199.146:2181
</code></pre><h3 id="使用守护进程方式运行"><a href="#使用守护进程方式运行" class="headerlink" title="使用守护进程方式运行"></a>使用守护进程方式运行</h3><pre><code>bin/zookeeper-server-start.sh -daemon config/zookeeper.properties
</code></pre><hr>
<h1 id="Kafka的特性"><a href="#Kafka的特性" class="headerlink" title="Kafka的特性"></a>Kafka的特性</h1><ul>
<li>高吞吐量、低延迟：kafka每秒可以处理几十万条消息，它的延迟最低只有几毫秒</li>
<li>可扩展性：kafka集群支持热扩展</li>
<li>持久性、可靠性：消息被持久化到本地磁盘，并且支持数据备份防止数据丢失</li>
<li>容错性：允许集群中节点失败（若副本数量为n,则允许n-1个节点失败）</li>
<li>高并发：支持数千个客户端同时读写</li>
</ul>
<h1 id="Kafka架构"><a href="#Kafka架构" class="headerlink" title="Kafka架构"></a>Kafka架构</h1><h3 id="Broker"><a href="#Broker" class="headerlink" title="Broker"></a>Broker</h3><p> Kafka集群包含一个或多个服务器，这种服务器被称为broker ### Topic</p>
<p> 每条发布到Kafka集群的消息都有一个类别，这个类别被称为Topic。（物理上不同Topic的消息分开存储，逻辑上一个Topic的消息虽然保存于一个或多个broker上但用户只需指定消息的Topic即可生产或消费数据而不必关心数据存于何处） <img src="http://o6qknsods.bkt.clouddn.com/markdown-f9ff2c32307a85372679bc7859fbbede.png-960.jpg" alt=""></p>
<h3 id="Partition"><a href="#Partition" class="headerlink" title="Partition"></a>Partition</h3><p> Parition是物理上的概念，每个Topic包含一个或多个Partition.每个partition物理上对应一个文件夹，该文件夹存储该partition的所有消息和索引文件。 正因为消息是以文件的形式存储的，所以无论消息是否被消费，kafka都会保留所有消息，有两种策略可以删除旧数据： &gt; 基于时间：log.retention.hours=168 基于大小：log.retention.bytes=1073741824</p>
<h4 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h4><p> 如果一个topic的名称为”my_topic”,有3个partitions，那么每个partitions 都分别对应有一个目录 my_topic_0、my_topic_1、my_topic_2；每个目录里放着具体的数据文件：消息跟索引文件。 ### Producer</p>
<p> 负责发布消息到Kafka broker 一般情况下存在三种情况： 1. At most once 消息可能会丢，但绝不会重复传输；</p>
<ol>
<li>At least one 消息绝不会丢，但可能会重复传输；</li>
<li>Exactly once 每条消息肯定会被传输一次且仅传输一次； 当 producer 向 broker 发送消息时，一这条消息被 commit，由于 replication 的存在，它就不会丢。但是如果 producer 发送数据给 broker 后，遇到网络问题而造成通信中断，那 Producer 就无法判断该条消息是否已经 commit。虽然 Kafka 无法确定网络故障期间发生了什么，但是 producer 可以生成一种类似于主键的东西，发生故障时幂等性的重试多次，这样就做到了 Exactly once，但目前还并未实现。所以目前默认情况下一条消息从 producer 到 broker 是确保了 At least once，可通过设置 producer 异步发送实现At most once。</li>
</ol>
<h4 id="路由机制"><a href="#路由机制" class="headerlink" title="路由机制"></a>路由机制</h4><p> producer 发送消息到 broker 时，会根据分区算法选择将其存储到哪一个 partition。其路由机制为： 1. 指定了 patition，则直接使用；</p>
<ol>
<li>未指定 patition 但指定 key，通过对 key 的 value 进行hash 选出一个 patition；默认情况下，Kafka根据传递消息的key来进行分区的分配，即hash(key)%numPartitions，这就保证了相同key的消息一定会被路由到相同的分区</li>
<li><p>patition 和 key 都未指定，使用轮询选出一个 patition。 Kafka几乎就是随机找一个分区发送无key的消息，然后把这个分区号加入到缓存中以备后面直接使用——当然了，Kafka本身也会清空该缓存（默认每10分钟或每次请求topic元数据时）</p>
<p>如果你的分区数是N，那么最好线程数也保持为N，这样通常能够达到最大的吞吐量。 ### Consumer</p>
<p>消息消费者，向Kafka broker读取消息的客户端。 ### Consumer Group</p>
<p>kafka中消费者组有两个概念：<strong>队列</strong>：消费者组（consumer group）允许同名的消费者组成员瓜分处理。<strong>发布-订阅</strong>：允许你广播消息给多个消费者组（不同名）。每个Consumer属于一个特定的Consumer Group（可为每个Consumer指定group name，若不指定group name则属于默认的group）。 ### 分布式</p>
<p>每个服务器处理它分到的分区。 根据配置每个分区还可以复制到其它服务器作为备份容错。 每个分区有一个leader，零或多个follower。Leader处理此分区的所有的读写请求，而follower被动的复制数据。如果leader宕机，其它的一个follower会被推举为新的leader。 一台服务器可能同时是一个分区的leader，另一个分区的follower。 这样可以平衡负载，避免所有的请求都只让一台或者某几台服务器处理。 </p>
<h1 id="Kafka拓扑结构"><a href="#Kafka拓扑结构" class="headerlink" title="Kafka拓扑结构"></a>Kafka拓扑结构</h1></li>
</ol>
<p><img src="http://o6qknsods.bkt.clouddn.com/markdown-dd2a4f4f389acba188a2639d08cb2f1c.png-960.jpg" alt=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">一个典型的kafka集群中包含若干producer（可以是web前端产生的page view，或者是服务器日志，系统CPU、memory等），若干broker（Kafka支持水平扩展，一般broker数量越多，集群吞吐率越高），若干consumer group，以及一个Zookeeper集群。Kafka通过Zookeeper管理集群配置，选举leader，以及在consumer group发生变化时进行rebalance。producer使用push模式将消息发布到broker，consumer使用pull模式从broker订阅并消费消息。</div></pre></td></tr></table></figure></p>
<h1 id="消费示例"><a href="#消费示例" class="headerlink" title="消费示例"></a>消费示例</h1><p><img src="http://o6qknsods.bkt.clouddn.com/markdown-0901b900874a3846830faebab7c5ee19.png-960.jpg" alt=""> 通常来讲，消息模型可以分为两种， <strong>队列</strong>和<strong>发布-订阅式</strong>。 队列的处理方式是 一组消费者从服务器读取消息，一条消息只有其中的一个消费者来处理。在发布-订阅模型中，消息被广播给所有的消费者，接收到消息的消费者都可以处理此消息。Kafka为这两种模型提供了单一的消费者抽象模型： 消费者组 （consumer group）。 消费者用一个消费者组名标记自己。 一个发布在Topic上消息被分发给此消费者组中的一个消费者。 假如所有的消费者都在一个组中，那么这就变成了queue模型。 假如所有的消费者都在不同的组中，那么就完全变成了发布-订阅模型。 更通用的， 我们可以创建一些消费者组作为逻辑上的订阅者。每个组包含数目不等的消费者， 一个组内多个消费者可以用来扩展性能和容错。正如上图所示： <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2个kafka集群托管4个分区（P0-P3），2个消费者组，消费组A有2个消费者实例，消费组B有4个。</div></pre></td></tr></table></figure></p>
<h1 id="kafka-broker宕机-amp-leader选举机制"><a href="#kafka-broker宕机-amp-leader选举机制" class="headerlink" title="kafka broker宕机 &amp; leader选举机制"></a>kafka broker宕机 &amp; leader选举机制</h1><p>为了保证高可用，每个分区都会有一定数量的副本（replica）。这样如果有部分服务器不可用，副本所在的服务器就会接替上来，保证应用的持续性。但是，为了保证较高的处理效率，消息的读写都是在固定的一个副本上完成。这个副本就是所谓的Leader，而其他副本则是Follower。而Follower则会定期地到Leader上同步数据。 如果某个分区所在服务器宕机了，那么kafka会从该分区的其他副本中选择一个作为新的leader，之后所有的读写就转移到这个新的leader上来。 因此，leader的server承载了全部的请求压力,因此从集群的整体考虑,有多少个partitions就意味着有多少个”leader”,kafka会将”leader”均衡的分散在每个实例上,来确保整体的性能稳定. </p>
<h3 id="Leader选举"><a href="#Leader选举" class="headerlink" title="Leader选举"></a>Leader选举</h3><p> Kafka会在Zookeeper上针对每个Topic维护一个称为ISR（in-sync replica，已同步的副本）的集合，该集合中是一些分区的副本。只有当这些副本都跟Leader中的副本同步了之后，kafka才会认为消息已提交，并反馈给消息的生产者。如果这个集合有增减，kafka会更新zookeeper上的记录。 如果某个分区的Leader不可用，Kafka就会从ISR集合中选择一个副本作为新的Leader。如果只允许一台机器失败，那么需要两个副本，只允许两台机器失败，则需要三个副本。 这里有一种极端的情况：所有的ISR副本都失败了，此时有两种方法可选，一种是等待ISR集合中的副本复活，一种是选择任何一个立即可用的副本，而这个副本不一定是在ISR集合中。&gt; 第一种：如果要等待ISR副本复活，虽然可以保证一致性，但可能需要很长时间。第二种如果选择立即可用的副本，则很可能该副本并不一致。</p>
<p>1.每个线程的一个消费者一个简单的选择是给每个线程自己的消费者实例。<br>     以下是这种方法的优点和缺点：<br>     PRO：最简单的实现PRO：它通常是最快的，因为不需要线程间协调PRO：它使每个分区的按顺序处理非常易于实现（每个线程都按照接收它们的顺序处理消息）。<br>     CON：更多的消费者意味着更多的TCP连接到集群（每个线程一个）。一般来说，卡夫卡非常有效地处理连接，所以这通常是一个很小的成本。 CON：多个消费者意味着更多的请求被发送到服务器，稍微少一点的数据批处理可能会导致I / O吞吐量的下降。 CON：所有进程的总线程数将受到分区总数的限制。 </p>
<p>2.消除和处理解耦另一种方法是让一个或多个消费者线程执行所有数据消耗，并将ConsumerRecords实例移交给实际处理记录处理的处理器线程池消耗的阻塞队列。<br>    此选项同样具有优点和缺点：<br>    PRO：该选项允许独立扩展消费者和处理器的数量。这使得可以让单个消费者提供许多处理器线程，避免对分区的任何限制。<br>    CON：跨处理器的保证顺序需要特别小心，因为线程将独立执行，因为稍后的数据块可能会由于线程执行时间的运行而在之前的数据块中被处理。对于没有订购要求的处理，这不是问题。<br>    CON：手动提交的位置变得更加困难，因为它要求所有线程协调，以确保该分区的处理完成。这种方法有很多可能的变化。例如，每个处理器线程可以具有自己的队列，并且消费者线程可以使用TopicPartition散列到这些队列中，以确保按顺序消费并简化提交。 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/02/zookeeper-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e4-b8-89-e5-8f-b0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/02/zookeeper-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e4-b8-89-e5-8f-b0/" itemprop="url">Zookeeper集群搭建(三台)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T17:52:55+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/06/02/zookeeper-e9-9b-86-e7-be-a4-e6-90-ad-e5-bb-ba-e4-b8-89-e5-8f-b0/" class="leancloud_visitors" data-flag-title="Zookeeper集群搭建(三台)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="zookeeper服务集群搭建-基于docker"><a href="#zookeeper服务集群搭建-基于docker" class="headerlink" title="zookeeper服务集群搭建(基于docker)"></a>zookeeper服务集群搭建(基于docker)</h1><blockquote>
<p>如果启动容器的时候使用–net host模式，那么这个容器将和宿主机共用一个Network Namespace。这时Docker Engine将不会为容器创建veth pair并配置IP等，而是直接使用宿主机的网络配置，就如直接跑在宿主机中的进程一样。注意，这时容器的其他资源，如文件系统、进程列表等还是和宿主机隔离的。 利用host网络，容器的IP地址和机器节点一致，这样我们在部署容器之前就能确定每个ZK节点的IP地址。我们可以分别在三台的机器上用host模式启动一个ZK容器并配置一个分布式集群。</p>
</blockquote>
<h2 id="对三台服务器进行zookeeper集群搭建："><a href="#对三台服务器进行zookeeper集群搭建：" class="headerlink" title="对三台服务器进行zookeeper集群搭建："></a>对三台服务器进行zookeeper集群搭建：</h2><h3 id="服务器A："><a href="#服务器A：" class="headerlink" title="服务器A："></a>服务器A：</h3><pre><code>docker run -d \ --name=zk1 \ --net=host \ -e SERVER_ID=1 \ -e ADDITIONAL_ZOOKEEPER_1=server.1=192.168.199.248:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_2=server.2=192.168.199.170:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_3=server.3=192.168.199.146:2888:3888 \ registry.aliyuncs.com/acs-sample/zookeeper:3.4.8
</code></pre><h3 id="服务器B："><a href="#服务器B：" class="headerlink" title="服务器B："></a>服务器B：</h3><pre><code>docker run -d \ --name=zk2 \ --net=host \ -e SERVER_ID=2 \ -e ADDITIONAL_ZOOKEEPER_1=server.1=192.168.199.248:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_2=server.2=192.168.199.170:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_3=server.3=192.168.199.146:2888:3888 \registry.aliyuncs.com/acs-sample/zookeeper:3.4.8
</code></pre><h3 id="服务器C："><a href="#服务器C：" class="headerlink" title="服务器C："></a>服务器C：</h3><pre><code>docker run -d \ --name=zk3 \ --net=host \ -e SERVER_ID=3 \ -e ADDITIONAL_ZOOKEEPER_1=server.1=192.168.199.248:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_2=server.2=192.168.199.170:2888:3888 \ -e ADDITIONAL_ZOOKEEPER_3=server.3=192.168.199.146:2888:3888 \registry.aliyuncs.com/acs-sample/zookeeper:3.4.8
</code></pre><h2 id="验证集群搭建情况"><a href="#验证集群搭建情况" class="headerlink" title="验证集群搭建情况"></a>验证集群搭建情况</h2><pre><code>telnet 192.168.199.248 2181 &gt; stat
</code></pre><p>   可以看到各台服务器状态，一台leader和多台flower即可说明集群搭建成功</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/22/linux-e5-ae-9a-e6-97-b6-e5-88-a0-e9-99-a4-e6-97-a5-e5-bf-97-e6-96-87-e4-bb-b6-e6-89-a7-e8-a1-8c-e8-84-9a-e6-9c-ac/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/22/linux-e5-ae-9a-e6-97-b6-e5-88-a0-e9-99-a4-e6-97-a5-e5-bf-97-e6-96-87-e4-bb-b6-e6-89-a7-e8-a1-8c-e8-84-9a-e6-9c-ac/" itemprop="url">linux定时删除日志文件执行脚本</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-22T22:25:44+08:00">
                2017-05-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/05/22/linux-e5-ae-9a-e6-97-b6-e5-88-a0-e9-99-a4-e6-97-a5-e5-bf-97-e6-96-87-e4-bb-b6-e6-89-a7-e8-a1-8c-e8-84-9a-e6-9c-ac/" class="leancloud_visitors" data-flag-title="linux定时删除日志文件执行脚本">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>linux是一个很能自动产生文件的系统，日志、邮件、备份等。虽然现在硬盘廉价，我们可以有很多硬盘空间供这些文件浪费，让系统定时清理一些不需要的文件很有一种爽快的事情。不用你去每天惦记着是否需要清理日志，不用每天收到硬盘空间不足的报警短信，想好好休息的话，让我们把这个事情交给机器定时去执行吧。 </p>
</blockquote>
<p><strong>1.删除文件命令</strong> </p>
<pre><code>find 对应目录 -mtime +天数 -name &quot;文件名&quot; -exec rm -rf {} \; 
</code></pre><p><strong>实例命令：</strong></p>
<pre><code>find /opt/soft/log/ -mtime +30 -name &quot;*.log&quot; -exec rm -rf {} \; 
</code></pre><p>说明： 将/opt/soft/log/目录下所有30天前带”.log”的文件删除。</p>
<p>具体参数说明如下： </p>
<ul>
<li><code>find</code>：linux的查找命令，用户查找指定条件的文件； </li>
<li><code>/opt/soft/log/</code>：想要进行清理的任意目录； </li>
<li><code>-mtime</code>：标准语句写法； </li>
<li><code>+30</code>：查找30天前的文件，这里用数字代表天数； </li>
<li><code>&quot;*.log&quot;</code>：希望查找的数据类型，”<em>.jpg”表示查找扩展名为jpg的所有文件，”</em>“表示查找所有文件，这个可以灵活运用，举一反三； </li>
<li><code>-exec</code>：固定写法；</li>
<li><code>rm -rf</code>：强制删除文件，包括目录；</li>
<li><code>{} \;</code>：固定写法，一对大括号+空格++; </li>
</ul>
<p><strong>2.计划任务</strong> </p>
<p>若嫌每次手动执行语句太麻烦，可以将这小语句写到一个可执行shell脚本文件中，再设置cron调度执行，那就可以让系统自动去清理相关文件。 </p>
<p><strong>2.1创建shell：</strong><br>    touch /opt/soft/bin/auto-del-30-days-ago-log.sh chmod +x auto-del-30-days-ago-log.sh 新建一个可执行文件auto-del-30-days-ago-log.sh，并分配可运行权限 </p>
<p><strong>2.2编辑shell脚本：</strong> </p>
<p>vi auto-del-30-days-ago-log.sh 编辑auto-del-30-days-ago-log.sh文件如下：</p>
<p> #!/bin/sh<br> find /opt/soft/log/ -mtime +30 -name “*.log” -exec rm -rf {} \; ok，保存退出(:wq)。 2.3计划任务： </p>
<p> #crontab -e<br> 将auto-del-30-days-ago-log.sh执行脚本加入到系统计划任务，到点自动执行 输入： 10 0 <em> </em> * /opt/soft/log/auto-del-7-days-ago-log.sh &gt;/dev/null 2&gt;&amp;1 这里的设置是每天凌晨0点10分执行auto-del-7-days-ago-log.sh文件进行数据清理任务了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/09/tcp-e8-bf-9e-e6-8e-a5-e7-9a-84-e6-8a-a5-e6-96-87-e5-88-b0-e8-be-be-e7-a1-ae-e8-ae-a4-e6-9c-ba-e5-88-b6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RUN">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://blog.iwannarun.cn/content/images/2017/09/funny.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要稳稳的RUN's Blogss">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/09/tcp-e8-bf-9e-e6-8e-a5-e7-9a-84-e6-8a-a5-e6-96-87-e5-88-b0-e8-be-be-e7-a1-ae-e8-ae-a4-e6-9c-ba-e5-88-b6/" itemprop="url">TCP连接的报文到达确认机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-09T04:09:31+08:00">
                2017-05-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/05/09/tcp-e8-bf-9e-e6-8e-a5-e7-9a-84-e6-8a-a5-e6-96-87-e5-88-b0-e8-be-be-e7-a1-ae-e8-ae-a4-e6-9c-ba-e5-88-b6/" class="leancloud_visitors" data-flag-title="TCP连接的报文到达确认机制">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>利用<code>tcpdump</code>命令查看Netty建立TCP连接时，报文数据的流向，如图</p>
<p><img src="http://o6qknsods.bkt.clouddn.com/markdown-41e512ecf3e2f9a297c22c143d835fb8.png-960.jpg" alt=""></p>
<ul>
<li><em>ACK</em>: 是对接收到的数据的最高序列号的确认，并向发送端返回一个下次接收时期望的TCP数据包的序列号（Ack Number）。例如， 主机A发送的当前数据序号是400，数据长度是100，则接收端收到后会返回一个确认号是500的确认号给主机A。</li>
<li><em>SEQ</em>: TCP会话的每一端都包含一个32位（bit）的序列号，该序列号被用来跟踪该端发送的数据量。每一个包中都包含序列号，在接收端则通过确认号用来通知发送端数据成功接收。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://blog.iwannarun.cn/content/images/2017/09/funny.gif"
                alt="RUN" />
            
              <p class="site-author-name" itemprop="name">RUN</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/iwannarun" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/tromsos" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-globe"></i>Weibo</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://iwannarun.cn/" title="Iwannarun" target="_blank">Iwannarun</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RUN</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.3"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("xTvsUA67SBVLnMhk4S1czdV2-gzGzoHsz", "6hzAL0zr1UDXY0vyKelVclxD");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
